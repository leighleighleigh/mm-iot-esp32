<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Morse Micro IoT SDK: WNM Sleep management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="favicon.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Morse Micro IoT SDK
   &#160;<span id="projectnumber">2.6.4-esp32</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__MMWLAN__WNM.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">WNM Sleep management<div class="ingroups"><a class="el" href="group__MMWLAN.html">Morse Micro Wireless LAN (mmwlan) API</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section note"><dt>Note</dt><dd>It is highly recommended to refer to Morse Micro App Note 04 on WNM sleep for a more detailed explanation on how this feature works.</dd></dl>
<p>WNM sleep is an extended power save mode in which the STA need not listen for every DTIM beacon and need not perform rekey, allowing the STA to remain associated and reduce power consumption when it has no traffic to send or receive from the AP. While a STA is in WNM sleep it will be unable to communicate with the AP, and thus any traffic for the STA may be buffered or dropped at the discretion of the AP while the STA is in WNM sleep.</p>
<dl class="section note"><dt>Note</dt><dd>WNM sleep can only be entered after the STA is associated to the AP. The AP must also support WNM sleep.</dd></dl>
<p>When entry to WNM sleep is enabled via this API, the STA sends a request to the AP and after successful negotiation, the chip is either put into a lower power mode or powered down completely, depending on arguments given when WNM sleep mode was enabled. The datapath is paused during this time. If the STA does not successfully negotiate with the AP to enter WNM Sleep, it will return an error code and the chip will not enter a low power mode.</p>
<p >When WNM sleep is disabled, the chip returns to normal operation and sends a request to the AP to exit WNM sleep. Note that the chip will exit low power mode regardless of whether or not the exit request was successful. WNM sleep will be exited if <a class="el" href="group__MMWLAN__CTRL.html#ga83480307a380060f5a1e03eaaf634081">mmwlan_shutdown</a> or <a class="el" href="group__MMWLAN__CTRL.html#gaea4e82b03668e794165ef372931bbe0d">mmwlan_sta_disable</a> is invoked.</p>
<p >If the AP takes down the link, then the station will be unaware until it sends the WNM Sleep exit request. At that point the AP will send a de-authentication frame with reason code "non-associated station". After validating this is actually the AP the station was connected to, the station will bring down the connection and return <a class="el" href="group__MMWLAN.html#gga0039072000d47e5c3712686bf1e43086ac9e2689a222cc3b398fc89b68a1f0006">MMWLAN_ERROR</a>. The station will attempt to re-associate but will not re-enter WNM sleep. The application needs to enable WNM sleep again via this API if required.</p>
<p >A high level overview of enabling and disabling WNM sleep is shown below.</p>
<p ><div class="plantumlgraph">
<img src="inline_umlgraph_1.png" />
</div>
  </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for storing WNM sleep extended arguments.  <a href="structmmwlan__set__wnm__sleep__enabled__args.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae4c20750960f4199eb754b7b3e10569b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MMWLAN__WNM.html#gae4c20750960f4199eb754b7b3e10569b">MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT</a>&#160;&#160;&#160;{ false, false }</td></tr>
<tr class="memdesc:gae4c20750960f4199eb754b7b3e10569b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializer for <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a>.  <a href="group__MMWLAN__WNM.html#gae4c20750960f4199eb754b7b3e10569b">More...</a><br /></td></tr>
<tr class="separator:gae4c20750960f4199eb754b7b3e10569b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf85591c76112034991c20aa454bb4fc2"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group__MMWLAN.html#ga0039072000d47e5c3712686bf1e43086">mmwlan_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MMWLAN__WNM.html#gaf85591c76112034991c20aa454bb4fc2">mmwlan_set_wnm_sleep_enabled_ext</a> (const struct <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a> *args)</td></tr>
<tr class="memdesc:gaf85591c76112034991c20aa454bb4fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets extended WNM sleep mode.  <a href="group__MMWLAN__WNM.html#gaf85591c76112034991c20aa454bb4fc2">More...</a><br /></td></tr>
<tr class="separator:gaf85591c76112034991c20aa454bb4fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac60e2b54d0f752de3d097eccf8b8a61e"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="group__MMWLAN.html#ga0039072000d47e5c3712686bf1e43086">mmwlan_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MMWLAN__WNM.html#gac60e2b54d0f752de3d097eccf8b8a61e">mmwlan_set_wnm_sleep_enabled</a> (bool wnm_sleep_enabled)</td></tr>
<tr class="memdesc:gac60e2b54d0f752de3d097eccf8b8a61e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets whether WNM sleep mode is enabled.  <a href="group__MMWLAN__WNM.html#gac60e2b54d0f752de3d097eccf8b8a61e">More...</a><br /></td></tr>
<tr class="separator:gac60e2b54d0f752de3d097eccf8b8a61e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gae4c20750960f4199eb754b7b3e10569b" name="gae4c20750960f4199eb754b7b3e10569b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4c20750960f4199eb754b7b3e10569b">&#9670;&nbsp;</a></span>MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT&#160;&#160;&#160;{ false, false }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializer for <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a>. </p>
<p >For example:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a> wnm_sleep_args = <a class="code hl_define" href="group__MMWLAN__WNM.html#gae4c20750960f4199eb754b7b3e10569b">MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT</a>;</div>
<div class="ttc" id="agroup__MMWLAN__WNM_html_gae4c20750960f4199eb754b7b3e10569b"><div class="ttname"><a href="group__MMWLAN__WNM.html#gae4c20750960f4199eb754b7b3e10569b">MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT</a></div><div class="ttdeci">#define MMWLAN_SET_WNM_SLEEP_ENABLED_ARGS_INIT</div><div class="ttdoc">Initializer for mmwlan_set_wnm_sleep_enabled_args.</div><div class="ttdef"><b>Definition:</b> <a href="mmwlan_8h_source.html#l01510">mmwlan.h:1510</a></div></div>
<div class="ttc" id="astructmmwlan__set__wnm__sleep__enabled__args_html"><div class="ttname"><a href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a></div><div class="ttdoc">Structure for storing WNM sleep extended arguments.</div><div class="ttdef"><b>Definition:</b> <a href="mmwlan_8h_source.html#l01493">mmwlan.h:1494</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="mmwlan_8h_source.html#l01510">1510</a> of file <a class="el" href="mmwlan_8h_source.html">mmwlan.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gac60e2b54d0f752de3d097eccf8b8a61e" name="gac60e2b54d0f752de3d097eccf8b8a61e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac60e2b54d0f752de3d097eccf8b8a61e">&#9670;&nbsp;</a></span>mmwlan_set_wnm_sleep_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="group__MMWLAN.html#ga0039072000d47e5c3712686bf1e43086">mmwlan_status</a> mmwlan_set_wnm_sleep_enabled </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wnm_sleep_enabled</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets whether WNM sleep mode is enabled. </p>
<p >If WNM sleep mode is enabled then the transceiver will sleep across multiple DTIM periods until WNM sleep mode is disabled. This allows the transceiver to use less power with the caveat that it will not wake up for group- or individually-addressed traffic. If a group rekey occurs while the device is in WNM sleep it will be applied when the device exits WNM sleep.</p>
<dl class="section note"><dt>Note</dt><dd>Data should not be queued for transmission (using, e.g., <a class="el" href="group__MMWLAN__DATA.html#gac6b6e52154bfe307d15cae475df33df3">mmwlan_tx()</a>) during WNM sleep. </dd>
<dd>
802.11 power save must be enabled for any benefit to be obtained (see <a class="el" href="group__MMWLAN__CTRL.html#ga8771bfc0223d560f1d27d61e69b88d64">mmwlan_set_power_save_mode()</a>). </dd>
<dd>
Negotiation with the AP is required to enter WNM sleep. As such the transceiver will only be placed into low power mode when a connection has been establish and the AP has accepted the request to enter WNM sleep. This will automatically be handled within mmwlan once WNM sleep mode is enabled.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wnm_sleep_enabled</td><td>Boolean indicating whether WNM sleep is enabled.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__MMWLAN.html#gga0039072000d47e5c3712686bf1e43086a559d87849add57871ea032a5a1a35c4c">MMWLAN_SUCCESS</a> on success, MMWLAN_UNAVAILABLE if already requested, else an appropriate error code. <a class="el" href="group__MMWLAN.html#gga0039072000d47e5c3712686bf1e43086a44ca87b719a15e19375cbcddd81bc152">MMWLAN_TIMED_OUT</a> if the maximum retry request reached. For WNM sleep exit request, this means that the device exited WNM sleep but failed to inform the AP. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mmwlan_8h_source.html#l01566">1566</a> of file <a class="el" href="mmwlan_8h_source.html">mmwlan.h</a>.</p>

</div>
</div>
<a id="gaf85591c76112034991c20aa454bb4fc2" name="gaf85591c76112034991c20aa454bb4fc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf85591c76112034991c20aa454bb4fc2">&#9670;&nbsp;</a></span>mmwlan_set_wnm_sleep_enabled_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__MMWLAN.html#ga0039072000d47e5c3712686bf1e43086">mmwlan_status</a> mmwlan_set_wnm_sleep_enabled_ext </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a> *&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets extended WNM sleep mode. </p>
<p >Provides an extended interface for setting WNM sleep. See <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a> for parameter details. If WNM sleep mode is enabled then the transceiver will sleep across multiple DTIM periods until WNM sleep mode is disabled. This allows the transceiver to use less power with the caveat that it will not wake up for group- or individually-addressed traffic. If a group rekey occurs while the device is in WNM sleep it will be applied when the device exits WNM sleep.</p>
<dl class="section note"><dt>Note</dt><dd>Data should not be queued for transmission (using, e.g., <a class="el" href="group__MMWLAN__DATA.html#gac6b6e52154bfe307d15cae475df33df3">mmwlan_tx()</a>) during WNM sleep. </dd>
<dd>
802.11 power save must be enabled for any benefit to be obtained (see <a class="el" href="group__MMWLAN__CTRL.html#ga8771bfc0223d560f1d27d61e69b88d64">mmwlan_set_power_save_mode()</a>). </dd>
<dd>
Negotiation with the AP is required to enter WNM sleep. As such the transceiver will only be placed into low power mode when a connection has been establish and the AP has accepted the request to enter WNM sleep. This will automatically be handled within mmwlan once WNM sleep mode is enabled.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>WNM sleep arguments - see <a class="el" href="structmmwlan__set__wnm__sleep__enabled__args.html">mmwlan_set_wnm_sleep_enabled_args</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__MMWLAN.html#gga0039072000d47e5c3712686bf1e43086a559d87849add57871ea032a5a1a35c4c">MMWLAN_SUCCESS</a> on success, MMWLAN_UNAVAILABLE if already requested, else an appropriate error code. <a class="el" href="group__MMWLAN.html#gga0039072000d47e5c3712686bf1e43086a44ca87b719a15e19375cbcddd81bc152">MMWLAN_TIMED_OUT</a> if the maximum retry request reached. For WNM sleep exit request, this means that the device exited WNM sleep but failed to inform the AP. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright 2021 Morse Micro </li>
  </ul>
</div>
</body>
</html>
